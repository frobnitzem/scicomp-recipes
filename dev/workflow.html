

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.1. Setting Up Your Project Environment &mdash; OLCF Cookbook  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/js/custom.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.2. Useful Shortcuts for Makefiles" href="make.html" />
    <link rel="prev" title="1. Development Tools" href="index.html" />

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> OLCF Cookbook
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">1. Development Tools</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1.1. Setting Up Your Project Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="make.html">1.2. Useful Shortcuts for Makefiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmake.html">1.3. Using cmake</a></li>
<li class="toctree-l2"><a class="reference internal" href="spack.html">1.4. Compiling Using Spack</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_submodules.html">1.5. Git Submodules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">2. HPC Programming Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/multi_impl.html">2.1. Multiple Implementations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/cuda.html">2.2. CUDA Programming Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/kokkos.html">2.3. Simple Kokkos Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/openmp.html">2.4. OpenMP and OpenACC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/pipeline.html">2.5. Assembly Line</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../comms/index.html">3. Communication Patterns</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../comms/nccl_allreduce.html">3.1. NCCL Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../perf/index.html">4. Performance Measurement</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../perf/user_timing.html">4.1. User-Level Timers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../perf/scaling.html">4.2. Making a Scaling Plot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../linalg/index.html">5. Linear Algebra</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../linalg/slate.html">5.1. SLATE Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apps/index.html">6. Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../apps/VASP6.html">6.1. Running Vasp 6 on OLCF</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">7. Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html#libraries">8. Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html#benchmark-code-examples">9. Benchmark Code Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">How to contribute to this book</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#submitting-suggestions">Submitting suggestions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#authoring-content">Authoring content</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/index.html#github-guidelines">GitHub Guidelines</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OLCF Cookbook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html"><span class="section-number">1. </span>Development Tools</a> &raquo;</li>
        
      <li><span class="section-number">1.1. </span>Setting Up Your Project Environment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/dev/workflow.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setting-up-your-project-environment">
<h1><span class="section-number">1.1. </span>Setting Up Your Project Environment<a class="headerlink" href="#setting-up-your-project-environment" title="Permalink to this headline">¶</a></h1>
<p>Let’s say you’re just getting started on project id CHM101.
A standard workflow on Summit is to build and install project
sources to <code class="docutils literal notranslate"><span class="pre">/ccs/proj/CHM101</span></code>, stage input/output files to
<code class="docutils literal notranslate"><span class="pre">/gpfs/alpine/proj-shared/CHM101</span></code>,
and use <code class="docutils literal notranslate"><span class="pre">/gpfs/alpine/scratch/$USER/CHM101</span></code>
during a run.</p>
<p>A good project layout will usually look like:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/ccs/proj/CHM101
    /spack         -- <span class="nb">local</span> spack installation <span class="k">for</span> dependencies
    /cp2k-June2021 -- project<span class="s1">&#39;s main application code</span>
<span class="s1">    /user1</span>
<span class="s1">       /python     -- local python environment</span>
<span class="s1">       /analysis1  -- user1&#39;</span>s scripts <span class="k">for</span> analysis
    README.md      -- explanation of your project layout, file locations and storage/transfer policy

/gpfs/alpine/proj-shared/CHM101
    /user1
        /experiment1 -- config files, lsf <span class="o">(</span>batch script<span class="o">)</span>, and key outputs
    /user2

/gpfs/alpine/world-shared/CHM101
    /user1
        /shared-dataset

/gpfs/alpine/scratch/user1/CHM101
    /experiment1 -- runtime scratch space <span class="k">for</span> experiment1
</pre></div>
</div>
<div class="section" id="installing-software">
<h2><span class="section-number">1.1.1. </span>Installing Software<a class="headerlink" href="#installing-software" title="Permalink to this headline">¶</a></h2>
<p>The first step is, of course, to download and install your application
codes and libraries.  For optimal performance, you’ll want to do these
steps yourself or have a way to check that they are performing correctly.</p>
<p>For example, the <span class="xref std std-doc">apps/CP2K</span> program depends largely
on GPU-enabled libraries for using the GPUs.</p>
<p>It’s important to check the available modules for available system-specific,
optimized dependencies.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>module spider mpi
</pre></div>
</div>
<p>It’s good practice to document your module environment
by creating a setup script.  Here’s an example
from cp2k.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1"># /ccs/proj/CHM101/cp2k-June2021/env.sh</span>
<span class="c1"># to use this, run &quot;source /ccs/proj/CHM101/cp2k-June2021/env.sh&quot;</span>

module load cmake
module load gcc
module load python/3
module load spectrum-mpi
module load cuda
module load hdf5
module load openblas
module load netlib-scalapack <span class="c1"># includes blas, CPU only</span>
<span class="c1"># non-threaded BLAS is preferred (TODO)</span>
module load fftw/3
module load gsl
</pre></div>
</div>
<div class="section" id="useful-info">
<h3><span class="section-number">1.1.1.1. </span>Useful Info<a class="headerlink" href="#useful-info" title="Permalink to this headline">¶</a></h3>
<p>On Summit, you should compile on the login nodes,
but stick to less than 4 or 8 processors
to be kind to other users.</p>
<p>Summit is an IBM system, and uses spectrum-mpi
as provided by a module.  It is based on openmpi 4.0.1,
and supports the MPI 3.2 standard.
(<a class="reference external" href="https://www.ibm.com/support/knowledgecenter/SSZTET_10.3/smpi_overview.html" target="_blank">https://www.ibm.com/support/knowledgecenter/SSZTET_10.3/smpi_overview.html</a>).
Spectrum updates are deployed every 6 months or so.
Upgrades and downtimes are announced weeks in advanced,
and put on the facility calendar.
Old modules become deprecated (but still available).
Keep track of your build process, because you will probably
want to re-build on these updates.</p>
<p>IBM has ESSL as a BLAS library, but it doesn’t include
all the lapack functions.  We also provide a netlib-scalapack
library that includes lapack/blas, as well as a separate openblas
library.</p>
<p>Summit’s hardware is documented at
<a class="reference external" href="https://docs.olcf.ornl.gov/systems/summit_user_guide.html#system-overview" target="_blank">https://docs.olcf.ornl.gov/systems/summit_user_guide.html#system-overview</a>
The V100 GPUs have compute capability 70, so the usual flag
passed to nvcc is –gpu_arch=sm_70.</p>
<p>Compilation and package choices should be informed by available
modules and/or the difficulty of building those libraries
manually.  Work incrementally if possible.</p>
<p>Usually, you can get important public, core libraries turned
into modules by emailing the help desk at <a class="reference external" href="mailto:help&#37;&#52;&#48;olcf&#46;ornl&#46;gov" target="_blank">help<span>&#64;</span>olcf<span>&#46;</span>ornl<span>&#46;</span>gov</a>.
But be sure you have tried them first and it’s what you really want
(so you have a complete request to email).</p>
<p>To test out your environment and develop LSF batch scripts
for running jobs, you can run interactively.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>bsub -P CHM101 -nnodes <span class="m">1</span> -q debug -W <span class="m">30</span> -Is <span class="nv">$SHELL</span>
</pre></div>
</div>
<p>Note that your interactive jobs are running on a launch node,
which is shared with other users.  You should limit yourself
to one processor on the launch nodes, and use jsrun to</p>
<p>Don’t compile on the launch nodes.  If you must, use jsrun
(equivalent of mpirun) to run make on a summit node instead.</p>
<p>When creating job scripts, it’s a good idea to test your
launch configuration using <a class="reference external" href="https://jobstepviewer.olcf.ornl.gov/" target="_blank">https://jobstepviewer.olcf.ornl.gov/</a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="make.html" class="btn btn-neutral float-right" title="1.2. Useful Shortcuts for Makefiles" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="1. Development Tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, OLCF

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    



</body>
</html>